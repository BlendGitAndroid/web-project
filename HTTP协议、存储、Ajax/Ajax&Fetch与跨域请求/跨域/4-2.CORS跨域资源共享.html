<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>CORS 跨域资源共享</title>
</head>
<body>
    <script>
        // CORS是浏览器的一种技术，用于实现跨域资源共享。CORS 是一种 W3C 标准，
        // 全称是跨域资源共享（Cross-Origin Resource Sharing）。
        // Access-Control-Allow-Origin 是一个 HTTP 响应头，用于实现 CORS（跨源资源共享）策略。
        // CORS 是一种机制，允许许多安全限制（例如同源策略）
        // 在可能会导致不安全的跨源请求中得以绕过。
        // 当浏览器发起跨源 HTTP 请求时，服务器可以通过在响应中包含 Access-Control-Allow-Origin 头来告诉浏览器，
        // 这个请求是被接受的。
        // 这个头的值可以是发起请求的源（即协议、域名和端口），也可以是 "*" 表示接受任何源的请求。
        // 例如，如果服务器返回的响应包含以下头：
        // 那么只有来自 https://example.com 的请求才会被接受。如果是其他源的请求，浏览器会阻止访问响应。
        // 如果服务器返回的响应包含以下头：
        // 那么任何源的请求都会被接受。
        // Access-Control：访问控制
        // Allow：允许
        // Origin：来源
        // 注意，虽然 Access-Control-Allow-Origin 头可以允许跨源请求，但是是否真的可以成功访问响应，还需要考虑其他的 CORS 相关头，
        // 例如 Access-Control-Allow-Credentials、Access-Control-Allow-Methods 等。
        // 1.CORS 是什么
        // const url = 'https://www.imooc.com';

        const url = 'https://www.imooc.com/api/http/search/suggest?words=js';
        const xhr = new XMLHttpRequest();

        xhr.onreadystatechange = () => {
            if (xhr.readyState != 4) return;

            if ((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {
                console.log(xhr.responseText);
            }
        };

        xhr.open('GET', url, true);

        xhr.send(null);

        // Access-Control-Allow-Origin: *
        // 表明允许所有的域名来跨域请求它，* 是通配符，没有任何限制

        // 只允许指定域名的跨域请求
        // Access-Control-Allow-Origin: http://127.0.0.1:5500

        // 2.使用 CORS 跨域的过程
        // ① 浏览器发送请求
        // ② 后端在响应头中添加 Access-Control-Allow-Origin 头信息
        // ③ 浏览器接收到响应
        // ④ 如果是同域下的请求，浏览器不会额外做什么，这次前后端通信就圆满完成了
        // ⑤ 如果是跨域请求，浏览器会从响应头中查找是否允许跨域访问
        // ⑥ 如果允许跨域，通信圆满完成
        // ⑦ 如果没找到或不包含想要跨域的域名，就丢弃响应结果

        // 3.CORS 的兼容性
        // IE10 及以上版本的浏览器可以正常使用 CORS

        // https://caniuse.com/
    </script>
</body>
</html>
